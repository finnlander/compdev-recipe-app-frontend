<div class="row">
  <div class="col-xs-12 col-md-6 col-md-offset-3">
    <div *ngIf="loggedOut" class="alert alert-success" role="alert">
      <h1>Logged out!</h1>
    </div>
    <div
      class="panel"
      [ngClass]="formMode === 'login' ? 'panel-primary' : 'panel-success'"
    >
      <div class="panel-heading">
        <h3 class="panel-title">
          {{ formMode === "login" ? "Log in" : "Sign up" }}
        </h3>
      </div>
      <div class="panel-body">
        <form (ngSubmit)="onSubmit()" #form="ngForm">
          <div class="form-group form-group-lg">
            <label for="username">Username</label>
            <input
              class="form-control"
              type="email"
              id="username"
              name="username"
              placeholder="username@example.com"
              ngModel
              required
              [email]="formMode === 'signup'"
            />
          </div>
          <div class="form-group form-group-lg">
            <label for="password">Password</label>
            <input
              class="form-control"
              type="password"
              id="password"
              name="password"
              placeholder="password"
              ngModel
              required
              [minlength]="formMode === 'signup' ? 12 : 1"
              #passwordInput="ngModel"
            />
            <span
              *ngIf="!passwordInput.valid && passwordInput.touched"
              class="help-block"
              >Password with minimum length of 12 is required</span
            >
          </div>
          <div *ngIf="formMode === 'signup'" class="form-group form-group-lg">
            <label for="repeatPassword">Repeat password</label>
            <input
              class="form-control"
              type="password"
              id="repeatPassword"
              name="repeatPassword"
              placeholder="password"
              ngModel
              required
              appRequireEquality
              [requireEqualityTo]="passwordInput.value"
              #repeatPasswordInput="ngModel"
            />
            <span
              *ngIf="!repeatPasswordInput.valid && repeatPasswordInput.touched"
              class="help-block"
              >Password values must match!</span
            >
          </div>
          <div>
            <button
              type="submit"
              class="btn btn-lg btn-primary"
              [ngClass]="formMode === 'login' ? 'btn-primary' : 'btn-success'"
              [disabled]="!form.valid || (loading$ | async)"
            >
              {{ formMode === "login" ? "Login" : "Sign Up" }}
            </button>

            <button
              type="button"
              class="btn btn-secondary ml-1"
              (click)="this.switchFormMode()"
              [disabled]="loading$ | async"
            >
              Switch to {{ formMode === "login" ? "sign up" : "login" }}
            </button>
          </div>
        </form>
      </div>
    </div>
    <app-alert
      *ngIf="error$ | async"
      type="error"
      [action]="formMode === 'login' ? 'Login' : 'Sign Up'"
      [message]="error$ | async"
      (dismiss)="onDismissError()"
    ></app-alert>
  </div>
  <ngx-spinner [showSpinner]="(loading$ | async) || false"></ngx-spinner>
</div>
